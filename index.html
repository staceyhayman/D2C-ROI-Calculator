<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accleration D2C ROI Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
        }
        .nav-menu {
            width: 250px;
            background-color: #0a1f16;
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            border-right: 4px solid #1a3c34;
        }
        .nav-menu h2 {
            padding: 0 20px;
            margin-bottom: 20px;
            color: #a4f574;
        }
        .nav-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .nav-menu li {
            padding: 0;
        }
        .nav-menu a {
            color: #fff;
            text-decoration: none;
            padding: 12px 20px;
            display: block;
            transition: background-color 0.3s, color 0.3s;
        }
        .nav-menu a:hover {
            background-color: #cdf986;
            color: #0a1f16;
        }
        .nav-menu a.active {
            background-color: #cdf986;
            color: #0a1f16;
        }
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            background: #fff;
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .input-section {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .input-section > div {
            flex: 1;
        }
        .growth-table {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
        }
        .growth-table table {
            margin-bottom: 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
            background-color: white;
            table-layout: fixed;
            border-radius: 14px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .cost-inputs-table td:first-child {
            width: 32%;
            min-width: 120px;
            max-width: 180px;
            word-break: break-word;
        }
        .cost-inputs-table td:last-child {
            width: 68%;
        }
        .cost-slider {
            width: 80%;
            min-width: 180px;
            max-width: 350px;
            margin-right: 10px;
        }
        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        input[type="number"] {
            width: 120px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .section {
            margin-bottom: 30px;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .section-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1a3c34;
            border-left: 6px solid #cdf986;
            padding-left: 12px;
        }
        h1 {
            color: #0a1f16;
            text-align: center;
            margin-bottom: 30px;
        }
        .result-value {
            font-weight: bold;
            color: #0a1f16;
        }
        .positive {
            color: #27ae60;
        }
        .negative {
            color: #e74c3c;
        }
        .table-row-flex {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .table-row-flex .section {
            flex: 1 1 0;
            min-width: 0;
            max-width: 50%;
            margin-bottom: 0;
        }
        .custom-api-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            border-radius: 14px;
            overflow: hidden;
        }
        .custom-api-table th, .custom-api-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        .custom-api-header {
            background: #b6ffb0;
            font-weight: bold;
            color: #0a1f16;
        }
        .custom-api-label {
            font-weight: normal;
            background: #fff;
            text-align: left;
        }
        .custom-api-gmv, .custom-api-gross, .custom-api-profit {
            background: #fff;
        }
        .custom-api-total {
            background: #cdf986;
            font-weight: bold;
            color: #0a1f16;
        }
        .custom-api-bold {
            font-weight: bold;
        }
        button {
            background: #cdf986;
            color: #0a1f16;
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s, color 0.3s;
            font-weight: bold;
        }
        button:hover {
            background: #b6ffb0;
            color: #0a1f16;
        }
    </style>
</head>
<body>
    <nav class="nav-menu">
        <h2>ROI Calculator</h2>
        <ul>
            <li><a href="#inputs" class="active" data-page="inputs">Input Parameters</a></li>
            <li><a href="#growth" data-page="growth">Plus Upgrade Growth</a></li>
            <li><a href="#checkout" data-page="checkout">Checkout Customizations</a></li>
            <li><a href="#audiences" data-page="audiences">Shopify Audiences</a></li>
            <li><a href="#shop-pay" data-page="shop-pay">Shop Pay</a></li>
            <li><a href="#support" data-page="support">Plus Support</a></li>
            <li><a href="#costs" data-page="costs">Costs $</a></li>
        </ul>
    </nav>

    <div class="main-content">
        <!-- Costs $ Page -->
        <div id="costs" class="page">
            <h1>Costs $</h1>
            <div class="section">
                <div class="section-title">Shopify Plan Cost Comparison</div>
                <table id="costs-table">
                    <tr>
                        <th>Merchant Annual GMV</th>
                        <th>Monthly Basic + SP Annual Cost</th>
                        <th>Monthly Shopify + SP Annual Cost</th>
                        <th>Basic → Shopify True Upgrade Cost / Yr</th>
                        <th>Monthly Advanced + SP Annual Cost</th>
                        <th>Shopify → Advanced True Upgrade Cost / Yr</th>
                        <th>Plus 1yr + SP Annual Cost</th>
                        <th>Plus 3yr + SP Annual Cost</th>
                        <th>Advanced → Plus 1yr True Upgrade Cost / Yr</th>
                        <th>Advanced → Plus 3yr True Upgrade Cost / Yr</th>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Input Parameters Page -->
        <div id="inputs" class="page active">
            <h1>Input Parameters</h1>
            <div class="section">
                <div class="section-title">Cost Inputs</div>
                <table class="cost-inputs-table">
                    <tr>
                        <td>Merchant Annual GMV</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="annual-gmv" value="1000000" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>True Cost (1Y)</td>
                        <td id="true-cost-1y">$0</td>
                    </tr>
                    <tr>
                        <td>True Cost (3Y)</td>
                        <td id="true-cost-3y">$0</td>
                    </tr>
                    <tr>
                        <td>Average Order Value (AOV)</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="aov" value="70" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>Average # of Transactions</td>
                        <td><input type="number" id="annual-transactions" value="35000" step="any"></td>
                    </tr>
                    <tr>
                        <td>Profit Margin</td>
                        <td><input type="range" class="cost-slider" id="profit-margin" min="0" max="100" value="15" step="1" oninput="document.getElementById('profit-margin-value').textContent = this.value + '%'">
                        <span id="profit-margin-value">15%</span></td>
                    </tr>
                    <tr>
                        <td>Ad Spend</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="ad-spend" value="50000" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>Retargeting Budget Allocation</td>
                        <td><input type="range" class="cost-slider" id="retargeting-budget" min="0" max="100" value="15" step="1" oninput="document.getElementById('retargeting-budget-value').textContent = this.value + '%'">
                        <span id="retargeting-budget-value">15%</span></td>
                    </tr>
                    <tr>
                        <td>Retargeting CPA</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="retargeting-cpa" value="75" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>Prospecting CPA</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="prospecting-cpa" value="100" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>LTV</td>
                        <td><span style="font-weight:bold">$</span><input type="number" id="ltv" value="200" style="width:110px; margin-left:4px;" step="any"></td>
                    </tr>
                    <tr>
                        <td>Payments Profile Online</td>
                        <td><input type="range" class="cost-slider" id="payments-profile" min="0" max="100" value="100" oninput="document.getElementById('payments-profile-value').textContent = this.value + '%'">
                        <span id="payments-profile-value">100%</span></td>
                    </tr>
                    <tr>
                        <td>Orders processed on Shopify Payments</td>
                        <td><input type="range" class="cost-slider" id="orders-payments" min="0" max="100" value="100" oninput="document.getElementById('orders-payments-value').textContent = this.value + '%'">
                        <span id="orders-payments-value">100%</span></td>
                    </tr>
                    <tr>
                        <td>Current Conversion Rate (%)</td>
                        <td><input type="range" class="cost-slider" id="conversion-rate" min="0" max="100" value="3" oninput="document.getElementById('conversion-rate-value').textContent = this.value + '%'">
                        <span id="conversion-rate-value">3%</span></td>
                    </tr>
                    <tr>
                        <td>Shop Pay Usage (%)</td>
                        <td><input type="range" class="cost-slider" id="shop-pay-usage" min="0" max="100" value="40" oninput="document.getElementById('shop-pay-usage-value').textContent = this.value + '%'">
                        <span id="shop-pay-usage-value">40%</span></td>
                    </tr>
                </table>
                <button id="calculate-btn" style="margin-top: 15px; padding: 10px 20px; font-size: 1em;">Calculate</button>
            </div>
        </div>

        <!-- Plus Upgrade Growth Page -->
        <div id="growth" class="page">
            <h1>Plus Upgrade Growth</h1>
            <div class="section growth-table">
                <div class="section-title">Growth from Upgrading</div>
                <table style="border-radius: 14px; overflow: hidden;">
                    <tr>
                        <th style="background: #f0f1f3;"></th>
                        <th>Medium Growth</th>
                        <th>High Growth</th>
                    </tr>
                    <tr>
                        <td>Checkout Customization with API</td>
                        <td id="checkout-custom-medium">$0.00</td>
                        <td id="checkout-custom-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Checkout Upsell with 3P apps</td>
                        <td id="checkout-upsell-medium">$0.00</td>
                        <td id="checkout-upsell-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Plus Support Help</td>
                        <td id="plus-support-medium">$0.00</td>
                        <td id="plus-support-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Increased Retargeting with Audiences</td>
                        <td id="audiences-medium">$0.00</td>
                        <td id="audiences-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Increased Conversion with Shop Pay</td>
                        <td id="shop-pay-conv-medium">$0.00</td>
                        <td id="shop-pay-conv-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Increased AOV with Shop Pay</td>
                        <td id="shop-pay-aov-medium">$0.00</td>
                        <td id="shop-pay-aov-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Increased Conversion without Shop Pay</td>
                        <td id="non-shop-pay-medium">$0.00</td>
                        <td id="non-shop-pay-high">$0.00</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Checkout Customizations Page -->
        <div id="checkout" class="page">
            <h1>Checkout Customizations</h1>
            <div class="table-row-flex">
                <div class="section">
                    <div class="section-title">Checkout Customization with API</div>
                    <table class="custom-api-table">
                        <tr>
                            <td style="width: 20%;"></td>
                            <th class="custom-api-header" colspan="3">Improvement in % conversion rate</th>
                        </tr>
                        <tr>
                            <td style="font-weight:bold; text-align:center;">GMV</td>
                            <td class="custom-api-header">Low<br><span class="custom-api-bold">1%</span></td>
                            <td class="custom-api-header">Med<br><span class="custom-api-bold">3%</span></td>
                            <td class="custom-api-header">High<br><span class="custom-api-bold">5%</span></td>
                        </tr>
                        <tr>
                            <td id="custom-gmv-base" style="text-align:center;"></td>
                            <td class="custom-api-gmv" id="custom-gmv-low">$0</td>
                            <td class="custom-api-gmv" id="custom-gmv-med">$0</td>
                            <td class="custom-api-gmv" id="custom-gmv-high">$0</td>
                        </tr>
                        <tr>
                            <td class="custom-api-label">Gross Revenue Increase</td>
                            <td class="custom-api-gross" id="custom-gross-low">$0</td>
                            <td class="custom-api-gross" id="custom-gross-med">$0</td>
                            <td class="custom-api-gross" id="custom-gross-high">$0</td>
                        </tr>
                        <tr>
                            <td class="custom-api-label">Profit Margin</td>
                            <td class="custom-api-profit" id="custom-profit-low">0%</td>
                            <td class="custom-api-profit" id="custom-profit-med">0%</td>
                            <td class="custom-api-profit" id="custom-profit-high">0%</td>
                        </tr>
                        <tr>
                            <td class="custom-api-total">Net Revenue Annual</td>
                            <td class="custom-api-total" id="custom-net-low">$0</td>
                            <td class="custom-api-total" id="custom-net-med">$0</td>
                            <td class="custom-api-total" id="custom-net-high">$0</td>
                        </tr>
                    </table>
                </div>
                <div class="section">
                    <div class="section-title">Checkout Upsell with 3P apps</div>
                    <table class="custom-api-table">
                        <tr>
                            <td style="width: 20%;"></td>
                            <th class="custom-api-header" colspan="3">Increase in AOV</th>
                        </tr>
                        <tr>
                            <td style="font-weight:bold; text-align:center;">AOV</td>
                            <td class="custom-api-header">Low<br><span class="custom-api-bold">5%</span></td>
                            <td class="custom-api-header">Med<br><span class="custom-api-bold">10%</span></td>
                            <td class="custom-api-header">High<br><span class="custom-api-bold">20%</span></td>
                        </tr>
                        <tr>
                            <td id="upsell-aov-base" style="text-align:center;"></td>
                            <td class="custom-api-gmv" id="upsell-aov-low">$0</td>
                            <td class="custom-api-gmv" id="upsell-aov-med">$0</td>
                            <td class="custom-api-gmv" id="upsell-aov-high">$0</td>
                        </tr>
                        <tr>
                            <td class="custom-api-label">Gross Revenue Increase</td>
                            <td class="custom-api-gross" id="upsell-gross-low">$0</td>
                            <td class="custom-api-gross" id="upsell-gross-med">$0</td>
                            <td class="custom-api-gross" id="upsell-gross-high">$0</td>
                        </tr>
                        <tr>
                            <td class="custom-api-label">Profit Margin</td>
                            <td class="custom-api-profit" id="upsell-profit-low">0%</td>
                            <td class="custom-api-profit" id="upsell-profit-med">0%</td>
                            <td class="custom-api-profit" id="upsell-profit-high">0%</td>
                        </tr>
                        <tr>
                            <td class="custom-api-total">Net Revenue Annual</td>
                            <td class="custom-api-total" id="upsell-net-low">$0</td>
                            <td class="custom-api-total" id="upsell-net-med">$0</td>
                            <td class="custom-api-total" id="upsell-net-high">$0</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Shopify Audiences Page -->
        <div id="audiences" class="page">
            <h1>Shopify Audiences</h1>
            <div class="section">
                <div class="section-title">Increased Retargeting with Audiences</div>
                <table id="audiences-table">
                    <tr>
                        <th>Metric</th>
                        <th>Current</th>
                        <th>Low</th>
                        <th>Med</th>
                        <th>High</th>
                    </tr>
                    <tr>
                        <td>Digital Ad Spend (Annual)</td>
                        <td id="audiences-ad-spend-current">$0.00</td>
                        <td id="audiences-ad-spend-low">$0.00</td>
                        <td id="audiences-ad-spend-med">$0.00</td>
                        <td id="audiences-ad-spend-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Retargeting %</td>
                        <td id="audiences-retargeting-pct-current">0%</td>
                        <td id="audiences-retargeting-pct-low">0%</td>
                        <td id="audiences-retargeting-pct-med">0%</td>
                        <td id="audiences-retargeting-pct-high">0%</td>
                    </tr>
                    <tr>
                        <td>Prospecting Spend</td>
                        <td id="audiences-prospecting-spend-current">$0.00</td>
                        <td id="audiences-prospecting-spend-low">$0.00</td>
                        <td id="audiences-prospecting-spend-med">$0.00</td>
                        <td id="audiences-prospecting-spend-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Retargeting Spend</td>
                        <td id="audiences-retargeting-spend-current">$0.00</td>
                        <td id="audiences-retargeting-spend-low">$0.00</td>
                        <td id="audiences-retargeting-spend-med">$0.00</td>
                        <td id="audiences-retargeting-spend-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>% Reduction in Retargeting CPA</td>
                        <td id="audiences-retargeting-cpa-reduction-current">0%</td>
                        <td id="audiences-retargeting-cpa-reduction-low">0%</td>
                        <td id="audiences-retargeting-cpa-reduction-med">0%</td>
                        <td id="audiences-retargeting-cpa-reduction-high">0%</td>
                    </tr>
                    <tr>
                        <td>% Reduction in Prospecting CPA</td>
                        <td id="audiences-prospecting-cpa-reduction-current">0%</td>
                        <td id="audiences-prospecting-cpa-reduction-low">0%</td>
                        <td id="audiences-prospecting-cpa-reduction-med">0%</td>
                        <td id="audiences-prospecting-cpa-reduction-high">0%</td>
                    </tr>
                    <tr>
                        <td>Prospecting CPA</td>
                        <td id="audiences-prospecting-cpa-current">$0.00</td>
                        <td id="audiences-prospecting-cpa-low">$0.00</td>
                        <td id="audiences-prospecting-cpa-med">$0.00</td>
                        <td id="audiences-prospecting-cpa-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Retargeting CPA</td>
                        <td id="audiences-retargeting-cpa-current">$0.00</td>
                        <td id="audiences-retargeting-cpa-low">$0.00</td>
                        <td id="audiences-retargeting-cpa-med">$0.00</td>
                        <td id="audiences-retargeting-cpa-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Prospecting Orders</td>
                        <td id="audiences-prospecting-orders-current">0</td>
                        <td id="audiences-prospecting-orders-low">0</td>
                        <td id="audiences-prospecting-orders-med">0</td>
                        <td id="audiences-prospecting-orders-high">0</td>
                    </tr>
                    <tr>
                        <td>Retargeting Orders</td>
                        <td id="audiences-retargeting-orders-current">0</td>
                        <td id="audiences-retargeting-orders-low">0</td>
                        <td id="audiences-retargeting-orders-med">0</td>
                        <td id="audiences-retargeting-orders-high">0</td>
                    </tr>
                    <tr>
                        <td>Total Orders</td>
                        <td id="audiences-total-orders-current">0</td>
                        <td id="audiences-total-orders-low">0</td>
                        <td id="audiences-total-orders-med">0</td>
                        <td id="audiences-total-orders-high">0</td>
                    </tr>
                    <tr>
                        <td>Increased Orders due to Audiences</td>
                        <td id="audiences-increased-orders-current">0</td>
                        <td id="audiences-increased-orders-low">0</td>
                        <td id="audiences-increased-orders-med">0</td>
                        <td id="audiences-increased-orders-high">0</td>
                    </tr>
                    <tr>
                        <td>LTV</td>
                        <td id="audiences-ltv-current">$0.00</td>
                        <td id="audiences-ltv-low">$0.00</td>
                        <td id="audiences-ltv-med">$0.00</td>
                        <td id="audiences-ltv-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Revenue Impact due to Audiences</td>
                        <td id="audiences-revenue-impact-current">$0.00</td>
                        <td id="audiences-revenue-impact-low">$0.00</td>
                        <td id="audiences-revenue-impact-med">$0.00</td>
                        <td id="audiences-revenue-impact-high">$0.00</td>
                    </tr>
                    <tr>
                        <td>Operating Margin</td>
                        <td id="audiences-operating-margin-current">0%</td>
                        <td id="audiences-operating-margin-low">0%</td>
                        <td id="audiences-operating-margin-med">0%</td>
                        <td id="audiences-operating-margin-high">0%</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Shop Pay Page -->
        <div id="shop-pay" class="page">
            <h1>Shop Pay</h1>
            <div class="table-row-flex">
                <div class="section">
                    <div class="section-title">Increased Conversion with Shop Pay</div>
                    <table>
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Conversion Rate Increase</td>
                            <td id="shop-pay-conv-increase">0%</td>
                        </tr>
                        <tr>
                            <td>New Conversion Rate</td>
                            <td id="shop-pay-new-conv">0%</td>
                        </tr>
                        <tr>
                            <td>Additional Orders</td>
                            <td id="shop-pay-orders">0</td>
                        </tr>
                        <tr>
                            <td>Revenue Impact</td>
                            <td id="shop-pay-revenue">$0.00</td>
                        </tr>
                        <tr>
                            <td>Margin Impact</td>
                            <td id="shop-pay-margin">$0.00</td>
                        </tr>
                    </table>
                </div>
                <div class="section">
                    <div class="section-title">Increased Conversion without Shop Pay</div>
                    <table>
                        <tr>
                            <th>Metric</th>
                            <th>Value</th>
                        </tr>
                        <tr>
                            <td>Conversion Rate Increase</td>
                            <td id="non-shop-pay-conv-increase">0%</td>
                        </tr>
                        <tr>
                            <td>New Conversion Rate</td>
                            <td id="non-shop-pay-new-conv">0%</td>
                        </tr>
                        <tr>
                            <td>Additional Orders</td>
                            <td id="non-shop-pay-orders">0</td>
                        </tr>
                        <tr>
                            <td>Revenue Impact</td>
                            <td id="non-shop-pay-revenue">$0.00</td>
                        </tr>
                        <tr>
                            <td>Margin Impact</td>
                            <td id="non-shop-pay-margin">$0.00</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Plus Support Page -->
        <div id="support" class="page">
            <h1>Plus Support</h1>
            <div class="section">
                <div class="section-title">Plus Support Help</div>
                <table>
                    <tr>
                        <th>Metric</th>
                        <th>Value</th>
                    </tr>
                    <tr>
                        <td>Conversion Rate Increase</td>
                        <td id="plus-support-conv-increase">0%</td>
                    </tr>
                    <tr>
                        <td>New Conversion Rate</td>
                        <td id="plus-support-new-conv">0%</td>
                    </tr>
                    <tr>
                        <td>Additional Orders</td>
                        <td id="plus-support-orders">0</td>
                    </tr>
                    <tr>
                        <td>Revenue Impact</td>
                        <td id="plus-support-revenue">$0.00</td>
                    </tr>
                    <tr>
                        <td>Margin Impact</td>
                        <td id="plus-support-margin">$0.00</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Navigation functionality
        const navLinks = document.querySelectorAll('.nav-menu a');
        const pages = document.querySelectorAll('.page');

        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links and pages
                navLinks.forEach(l => l.classList.remove('active'));
                pages.forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked link and corresponding page
                this.classList.add('active');
                const pageId = this.getAttribute('data-page');
                document.getElementById(pageId).classList.add('active');
            });
        });

        console.log('Script loaded');
        try {
            // Only add listeners to sliders for live value update
            document.querySelectorAll('input[type="range"]').forEach(input => {
                input.addEventListener('input', function() {
                    // update value display only
                });
            });
            // Calculate button triggers calculation
            document.getElementById('calculate-btn').addEventListener('click', function() {
                try {
                    console.log('Calculate button clicked');
                    calculateAll();
                    console.log('After calculateAll');
                    updateCustomApiTable();
                    console.log('After updateCustomApiTable');
                    updateUpsellTable();
                    console.log('After updateUpsellTable');
                } catch (err) {
                    console.error('Error in Calculate button handler:', err);
                }
            });

            function calculateAll() {
                try {
                    // Get input values
                    const annualGMV = parseFloat(document.getElementById('annual-gmv').value);
                    const aov = parseFloat(document.getElementById('aov').value);
                    const annualTransactions = parseInt(document.getElementById('annual-transactions').value);
                    const profitMargin = parseFloat(document.getElementById('profit-margin').value) / 100;
                    const currentConversionRate = parseFloat(document.getElementById('conversion-rate').value) / 100;
                    console.log('calculateAll() input values:', {
                        annualGMV, aov, annualTransactions, profitMargin, currentConversionRate,
                        adSpend: document.getElementById('ad-spend').value,
                        retargetingBudget: document.getElementById('retargeting-budget').value,
                        retargetingCPA: document.getElementById('retargeting-cpa').value,
                        prospectingCPA: document.getElementById('prospecting-cpa').value,
                        ltv: document.getElementById('ltv').value,
                        paymentsProfile: document.getElementById('payments-profile').value,
                        ordersPayments: document.getElementById('orders-payments').value,
                        shopPayUsage: document.getElementById('shop-pay-usage').value
                    });

                    // Calculate for each feature and scenario
                    calculateFeature('checkout-custom', {
                        medium: { convIncrease: 0.03, cost: 0 },
                        high: { convIncrease: 0.05, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('checkout-upsell', {
                        medium: { aovIncrease: 0.10, cost: 0 },
                        high: { aovIncrease: 0.20, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('plus-support', {
                        medium: { convIncrease: 0.01, cost: 0 },
                        high: { convIncrease: 0.015, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('audiences', {
                        medium: { convIncrease: 0.04, cost: 0 },
                        high: { convIncrease: 0.06, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('shop-pay-conv', {
                        medium: { convIncrease: 0.05, cost: 0 },
                        high: { convIncrease: 0.07, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('shop-pay-aov', {
                        medium: { aovIncrease: 0.10, cost: 0 },
                        high: { aovIncrease: 0.20, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);

                    calculateFeature('non-shop-pay', {
                        medium: { convIncrease: 0.02, cost: 0 },
                        high: { convIncrease: 0.03, cost: 0 }
                    }, annualTransactions, aov, profitMargin, currentConversionRate);
                } catch (err) {
                    console.error('Error in calculateAll:', err);
                }
            }

            function calculateFeature(prefix, scenarios, annualTransactions, aov, profitMargin, currentConversionRate) {
                try {
                    // Calculate for each scenario
                    Object.entries(scenarios).forEach(([scenario, data]) => {
                        let revenueImpact, marginImpact;
                        
                        if (data.convIncrease) {
                            // Conversion rate based calculation
                            const newConversionRate = currentConversionRate * (1 + data.convIncrease);
                            const additionalOrders = annualTransactions * data.convIncrease;
                            revenueImpact = additionalOrders * aov;
                            marginImpact = revenueImpact * profitMargin;

                            // Update feature-specific table
                            if (scenario === 'medium') {
                                if (prefix === 'audiences') {
                                    // Calculate audience-specific metrics
                                    const adSpend = parseFloat(document.getElementById('ad-spend').value) || 0;
                                    const retargetingPct = parseFloat(document.getElementById('retargeting-budget').value) / 100 || 0;
                                    const prospectingCPA = parseFloat(document.getElementById('prospecting-cpa').value) || 0;
                                    const retargetingCPA = parseFloat(document.getElementById('retargeting-cpa').value) || 0;
                                    const ltv = parseFloat(document.getElementById('ltv').value) || 0;
                                    
                                    // Calculate spends
                                    const retargetingSpend = adSpend * retargetingPct;
                                    const prospectingSpend = adSpend - retargetingSpend;
                                    
                                    // Calculate CPA reductions
                                    const retargetingCPAReduction = 0.15; // 15% reduction
                                    const prospectingCPAReduction = 0.10; // 10% reduction
                                    
                                    // Calculate new CPAs
                                    const newRetargetingCPA = retargetingCPA * (1 - retargetingCPAReduction);
                                    const newProspectingCPA = prospectingCPA * (1 - prospectingCPAReduction);
                                    
                                    // Calculate orders
                                    const retargetingOrders = retargetingSpend / newRetargetingCPA;
                                    const prospectingOrders = prospectingSpend / newProspectingCPA;
                                    const totalOrders = retargetingOrders + prospectingOrders;
                                    
                                    // Calculate increased orders
                                    const baseRetargetingOrders = retargetingSpend / retargetingCPA;
                                    const baseProspectingOrders = prospectingSpend / prospectingCPA;
                                    const baseTotalOrders = baseRetargetingOrders + baseProspectingOrders;
                                    const increasedOrders = totalOrders - baseTotalOrders;
                                    
                                    // Calculate revenue impact
                                    const revenueImpact = increasedOrders * ltv;
                                    
                                    // Update table
                                    document.getElementById('audiences-ad-spend-current').textContent = adSpend.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                                    document.getElementById('audiences-retargeting-pct-current').textContent = (retargetingPct * 100).toFixed(0) + '%';
                                    document.getElementById('audiences-prospecting-spend-current').textContent = prospectingSpend.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                                    document.getElementById('audiences-retargeting-spend-current').textContent = retargetingSpend.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                                    document.getElementById('audiences-retargeting-cpa-reduction-current').textContent = (retargetingCPAReduction * 100).toFixed(0) + '%';
                                    document.getElementById('audiences-prospecting-cpa-reduction-current').textContent = (prospectingCPAReduction * 100).toFixed(0) + '%';
                                    document.getElementById('audiences-prospecting-cpa-current').textContent = newProspectingCPA.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                                    document.getElementById('audiences-retargeting-cpa-current').textContent = newRetargetingCPA.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                                    document.getElementById('audiences-prospecting-orders-current').textContent = Math.round(prospectingOrders).toLocaleString();
                                    document.getElementById('audiences-retargeting-orders-current').textContent = Math.round(retargetingOrders).toLocaleString();
                                    document.getElementById('audiences-total-orders-current').textContent = Math.round(totalOrders).toLocaleString();
                                    document.getElementById('audiences-increased-orders-current').textContent = Math.round(increasedOrders).toLocaleString();
                                    document.getElementById('audiences-ltv-current').textContent = ltv.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                                    document.getElementById('audiences-revenue-impact-current').textContent = revenueImpact.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                                    document.getElementById('audiences-operating-margin-current').textContent = (profitMargin * 100).toFixed(0) + '%';
                                } else {
                                    document.getElementById(`${prefix}-conv-increase`).textContent = `${(data.convIncrease * 100).toFixed(1)}%`;
                                    document.getElementById(`${prefix}-new-conv`).textContent = `${(newConversionRate * 100).toFixed(2)}%`;
                                    document.getElementById(`${prefix}-orders`).textContent = additionalOrders.toLocaleString();
                                    document.getElementById(`${prefix}-revenue`).textContent = `$${revenueImpact.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                    document.getElementById(`${prefix}-margin`).textContent = `$${marginImpact.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                }
                            }
                        } else if (data.aovIncrease) {
                            // AOV based calculation
                            const newAov = aov * (1 + data.aovIncrease);
                            revenueImpact = annualTransactions * (newAov - aov);
                            marginImpact = revenueImpact * profitMargin;

                            // Update feature-specific table
                            if (scenario === 'medium') {
                                document.getElementById(`${prefix}-aov-increase`).textContent = `${(data.aovIncrease * 100).toFixed(1)}%`;
                                document.getElementById(`${prefix}-new-aov`).textContent = `$${newAov.toFixed(2)}`;
                                document.getElementById(`${prefix}-revenue`).textContent = `$${revenueImpact.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                                document.getElementById(`${prefix}-margin`).textContent = `$${marginImpact.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                            }
                        }

                        // Update summary table
                        document.getElementById(`${prefix}-${scenario}`).textContent = 
                            `$${marginImpact.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                    });
                } catch (err) {
                    console.error('Error in calculateFeature:', err);
                }
            }

            // --- Custom API Table Calculation ---
            function updateCustomApiTable() {
                try {
                    const gmv = parseFloat(document.getElementById('annual-gmv').value) || 0;
                    const profitMargin = parseFloat(document.getElementById('profit-margin').value) / 100 || 0;
                    // Conversion rate improvements
                    const lowPct = 0.01, medPct = 0.03, highPct = 0.05;
                    // GMV for each scenario
                    const gmvLow = gmv * (1 + lowPct);
                    const gmvMed = gmv * (1 + medPct);
                    const gmvHigh = gmv * (1 + highPct);
                    // Gross Revenue Increase
                    const grossLow = gmvLow - gmv;
                    const grossMed = gmvMed - gmv;
                    const grossHigh = gmvHigh - gmv;
                    // Net Revenue Annual
                    const netLow = grossLow * profitMargin;
                    const netMed = grossMed * profitMargin;
                    const netHigh = grossHigh * profitMargin;
                    // Update table
                    document.getElementById('custom-gmv-base').textContent = gmv.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gmv-low').textContent = gmvLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gmv-med').textContent = gmvMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gmv-high').textContent = gmvHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gross-low').textContent = grossLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gross-med').textContent = grossMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-gross-high').textContent = grossHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-profit-low').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('custom-profit-med').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('custom-profit-high').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('custom-net-low').textContent = netLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-net-med').textContent = netMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('custom-net-high').textContent = netHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                } catch (err) {
                    console.error('Error in updateCustomApiTable:', err);
                }
            }

            // --- Upsell Table Calculation ---
            function updateUpsellTable() {
                try {
                    const aov = parseFloat(document.getElementById('aov').value) || 0;
                    const annualTransactions = parseFloat(document.getElementById('annual-transactions').value) || 0;
                    const profitMargin = parseFloat(document.getElementById('profit-margin').value) / 100 || 0;
                    // AOV increase scenarios
                    const lowPct = 0.05, medPct = 0.10, highPct = 0.20;
                    // Calculate just the increase amounts
                    const aovLow = aov * lowPct;
                    const aovMed = aov * medPct;
                    const aovHigh = aov * highPct;
                    // Gross Revenue Increase
                    const grossLow = aovLow * annualTransactions;
                    const grossMed = aovMed * annualTransactions;
                    const grossHigh = aovHigh * annualTransactions;
                    // Net Revenue Annual
                    const netLow = grossLow * profitMargin;
                    const netMed = grossMed * profitMargin;
                    const netHigh = grossHigh * profitMargin;
                    // Update table
                    document.getElementById('upsell-aov-base').textContent = aov.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                    document.getElementById('upsell-aov-low').textContent = aovLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                    document.getElementById('upsell-aov-med').textContent = aovMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                    document.getElementById('upsell-aov-high').textContent = aovHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:2});
                    document.getElementById('upsell-gross-low').textContent = grossLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('upsell-gross-med').textContent = grossMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('upsell-gross-high').textContent = grossHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('upsell-profit-low').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('upsell-profit-med').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('upsell-profit-high').textContent = (profitMargin*100).toFixed(0) + '%';
                    document.getElementById('upsell-net-low').textContent = netLow.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('upsell-net-med').textContent = netMed.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                    document.getElementById('upsell-net-high').textContent = netHigh.toLocaleString('en-US', {style:'currency', currency:'USD', maximumFractionDigits:0});
                } catch (err) {
                    console.error('Error in updateUpsellTable:', err);
                }
            }

            // Add Costs $ table data
            const costsData = [
                [50000, 1918, 2610, 692, 6038, 3428, 31125, 28725, 25087, 22687],
                [100000, 3368, 3960, 592, 7288, 3328, 32250, 29850, 24962, 22562],
                [150000, 4818, 5310, 492, 8538, 3228, 33375, 30975, 24837, 22437],
                [200000, 6268, 6660, 392, 9788, 3128, 34500, 32100, 24712, 22312],
                [250000, 7718, 8010, 292, 11038, 3028, 35625, 33225, 24587, 22187],
                [300000, 9168, 9360, 192, 12288, 2928, 36750, 34350, 24462, 22062],
                [400000, 12068, 12060, -8, 14788, 2728, 39000, 36600, 24212, 21812],
                [500000, 14968, 14760, -208, 17288, 2528, 41250, 38850, 23962, 21562],
                [600000, 17868, 17460, -408, 19788, 2328, 43500, 41100, 23712, 21312],
                [700000, 20768, 20160, -608, 22288, 2128, 45750, 43350, 23462, 21062],
                [800000, 23668, 22860, -808, 24788, 1928, 48000, 45600, 23212, 20812],
                [900000, 26568, 25560, -1008, 27288, 1728, 50250, 47850, 22962, 20562],
                [1000000, 29468, 28260, -1208, 29788, 1528, 52500, 50100, 22712, 20312],
                [1250000, 36718, 35010, -1708, 36038, 1028, 58125, 55725, 22087, 19687],
                [1500000, 43968, 41760, -2208, 42288, 528, 63750, 61350, 21462, 19062],
                [1750000, 51218, 48510, -2708, 48538, 28, 69375, 66975, 20837, 18437],
                [2000000, 58468, 55260, -3208, 54788, -472, 75000, 72600, 20212, 17812],
                [3000000, 87468, 82260, -5208, 79788, -2472, 97500, 95100, 17712, 15312],
                [4000000, 116468, 109260, -7208, 104788, -4472, 120000, 117600, 15212, 12812],
            ];
            const costsTable = document.getElementById('costs-table');
            costsData.forEach(row => {
                const tr = document.createElement('tr');
                row.forEach((cell, i) => {
                    const td = document.createElement('td');
                    if (i === 0) {
                        td.textContent = `$${cell.toLocaleString()}`;
                    } else {
                        td.textContent = cell < 0 ? `-$${Math.abs(cell).toLocaleString()}` : `$${cell.toLocaleString()}`;
                    }
                    tr.appendChild(td);
                });
                costsTable.appendChild(tr);
            });

            // Initial calculation
            console.log('Running initial calculations');
            calculateAll();
            updateCustomApiTable();
            updateUpsellTable();
            console.log('Initial calculations complete');

            // Ensure True Cost fields are set for default GMV on page load (move to end)
            updateTrueCosts();

            function updateTrueCosts() {
                let gmv = parseInt(document.getElementById('annual-gmv').value.replace(/[^0-9]/g, ''));
                // Find the closest lower GMV in costsData
                let found = null;
                for (let i = costsData.length - 1; i >= 0; i--) {
                    if (gmv >= costsData[i][0]) {
                        found = costsData[i];
                        break;
                    }
                }
                if (found) {
                    document.getElementById('true-cost-1y').textContent = `$${found[8].toLocaleString()}`;
                    document.getElementById('true-cost-3y').textContent = `$${found[9].toLocaleString()}`;
                } else {
                    document.getElementById('true-cost-1y').textContent = 'N/A';
                    document.getElementById('true-cost-3y').textContent = 'N/A';
                }
            }

            // Update True Costs when GMV changes
            document.getElementById('annual-gmv').addEventListener('input', updateTrueCosts);
        } catch (err) {
            console.error('Script initialization error:', err);
        }
    });
    </script>
</body>
</html> 